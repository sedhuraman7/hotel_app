{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///D:/hotal_project/web_app/lib/store.ts"],"sourcesContent":["\r\n// Simple in-memory store for the demo\r\n// In a real app, this would be a database like MongoDB or Postgres\r\n\r\nexport type Room = {\r\n    id: string; // Room Number (e.g. 101)\r\n    type: string;\r\n    deviceId: string; // ESP32 Device ID\r\n    status: \"Occupied\" | \"Vacant\" | \"Cleaning\";\r\n    currentGuest?: {\r\n        name: string;\r\n        cardId: string;\r\n        checkInTime: string;\r\n    };\r\n};\r\n\r\nexport type Log = {\r\n    id: string;\r\n    timestamp: string;\r\n    deviceId: string;\r\n    cardId: string;\r\n    type: string;\r\n    access: boolean;\r\n    message: string;\r\n};\r\n\r\n// Default Rooms with Device Binding (Mock)\r\nlet rooms: Room[] = [];\r\n\r\nlet logs: Log[] = [];\r\n\r\n// Pre-approved cards (Mock DB)\r\nconst authorizedCards: Record<string, string> = {};\r\n\r\nexport const db = {\r\n    getRooms: () => rooms,\r\n\r\n    getRoomById: (id: string) => rooms.find(r => r.id === id),\r\n\r\n    updateRoomStatus: (id: string, status: Room['status'], guestData?: Room['currentGuest']) => {\r\n        const room = rooms.find(r => r.id === id);\r\n        if (room) {\r\n            room.status = status;\r\n            room.currentGuest = guestData || undefined;\r\n        }\r\n    },\r\n\r\n    // UPDATE DEVICE BINDING\r\n    updateRoomDevice: (roomId: string, deviceId: string) => {\r\n        const room = rooms.find(r => r.id === roomId);\r\n        if (room) {\r\n            room.deviceId = deviceId;\r\n        }\r\n    },\r\n\r\n    // Check Access: Validates if Card is assigned to the Room associated with the Device\r\n    checkAccess: (cardId: string, deviceId: string) => {\r\n        // 1. Check Global/Staff cards first\r\n        if (authorizedCards[cardId]) return authorizedCards[cardId];\r\n\r\n        // 2. Find which room this Device belongs to\r\n        const room = rooms.find(r => r.deviceId === deviceId);\r\n\r\n        // 3. If room found, check if it is Occupied AND the Card matches the Guest's Card\r\n        if (room && room.status === \"Occupied\" && room.currentGuest?.cardId === cardId) {\r\n            return `Guest ${room.currentGuest.name} (Room ${room.id})`;\r\n        }\r\n\r\n        return null;\r\n    },\r\n\r\n    addLog: (log: Omit<Log, \"id\" | \"timestamp\">) => {\r\n        const newLog = {\r\n            ...log,\r\n            id: Math.random().toString(36).substring(7),\r\n            timestamp: new Date().toISOString()\r\n        };\r\n        logs.unshift(newLog); // Add to top\r\n        if (logs.length > 100) logs.pop(); // Keep size manageable\r\n        return newLog;\r\n    },\r\n\r\n    getLogs: () => logs,\r\n};\r\n"],"names":[],"mappings":"AACA,sCAAsC;AACtC,mEAAmE;;;;;AAwBnE,2CAA2C;AAC3C,IAAI,QAAgB,EAAE;AAEtB,IAAI,OAAc,EAAE;AAEpB,+BAA+B;AAC/B,MAAM,kBAA0C,CAAC;AAE1C,MAAM,KAAK;IACd,UAAU,IAAM;IAEhB,aAAa,CAAC,KAAe,MAAM,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;IAEtD,kBAAkB,CAAC,IAAY,QAAwB;QACnD,MAAM,OAAO,MAAM,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;QACtC,IAAI,MAAM;YACN,KAAK,MAAM,GAAG;YACd,KAAK,YAAY,GAAG,aAAa;QACrC;IACJ;IAEA,wBAAwB;IACxB,kBAAkB,CAAC,QAAgB;QAC/B,MAAM,OAAO,MAAM,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;QACtC,IAAI,MAAM;YACN,KAAK,QAAQ,GAAG;QACpB;IACJ;IAEA,qFAAqF;IACrF,aAAa,CAAC,QAAgB;QAC1B,oCAAoC;QACpC,IAAI,eAAe,CAAC,OAAO,EAAE,OAAO,eAAe,CAAC,OAAO;QAE3D,4CAA4C;QAC5C,MAAM,OAAO,MAAM,IAAI,CAAC,CAAA,IAAK,EAAE,QAAQ,KAAK;QAE5C,kFAAkF;QAClF,IAAI,QAAQ,KAAK,MAAM,KAAK,cAAc,KAAK,YAAY,EAAE,WAAW,QAAQ;YAC5E,OAAO,CAAC,MAAM,EAAE,KAAK,YAAY,CAAC,IAAI,CAAC,OAAO,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC;QAC9D;QAEA,OAAO;IACX;IAEA,QAAQ,CAAC;QACL,MAAM,SAAS;YACX,GAAG,GAAG;YACN,IAAI,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,SAAS,CAAC;YACzC,WAAW,IAAI,OAAO,WAAW;QACrC;QACA,KAAK,OAAO,CAAC,SAAS,aAAa;QACnC,IAAI,KAAK,MAAM,GAAG,KAAK,KAAK,GAAG,IAAI,uBAAuB;QAC1D,OAAO;IACX;IAEA,SAAS,IAAM;AACnB"}},
    {"offset": {"line": 102, "column": 0}, "map": {"version":3,"sources":["file:///D:/hotal_project/web_app/app/api/dashboard/stats/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\r\nimport { db } from \"@/lib/store\";\r\n\r\nexport async function GET() {\r\n    const rooms = db.getRooms();\r\n    const logs = db.getLogs().slice(0, 5); // Base 5 recent logs\r\n\r\n    const stats = {\r\n        occupied: rooms.filter(r => r.status === \"Occupied\").length,\r\n        vacant: rooms.filter(r => r.status === \"Vacant\").length,\r\n        cleaning: rooms.filter(r => r.status === \"Cleaning\").length,\r\n        // dirty: rooms.filter(r => r.status === \"Dirty\").length || 0,\r\n        totalGuests: rooms.reduce((acc, r) => acc + (r.status === \"Occupied\" ? 1 : 0), 0), // Simple count\r\n        recentLogs: logs,\r\n        revenue: 0, // No payment system linked yet\r\n    };\r\n\r\n    return NextResponse.json(stats);\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe;IAClB,MAAM,QAAQ,oHAAE,CAAC,QAAQ;IACzB,MAAM,OAAO,oHAAE,CAAC,OAAO,GAAG,KAAK,CAAC,GAAG,IAAI,qBAAqB;IAE5D,MAAM,QAAQ;QACV,UAAU,MAAM,MAAM,CAAC,CAAA,IAAK,EAAE,MAAM,KAAK,YAAY,MAAM;QAC3D,QAAQ,MAAM,MAAM,CAAC,CAAA,IAAK,EAAE,MAAM,KAAK,UAAU,MAAM;QACvD,UAAU,MAAM,MAAM,CAAC,CAAA,IAAK,EAAE,MAAM,KAAK,YAAY,MAAM;QAC3D,8DAA8D;QAC9D,aAAa,MAAM,MAAM,CAAC,CAAC,KAAK,IAAM,MAAM,CAAC,EAAE,MAAM,KAAK,aAAa,IAAI,CAAC,GAAG;QAC/E,YAAY;QACZ,SAAS;IACb;IAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;AAC7B"}}]
}